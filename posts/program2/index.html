<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Program2 - 饅頭的部落格</title><meta name=Description content><meta property="og:title" content="Program2">
<meta property="og:description" content="title: &ldquo;Program2&rdquo; tags: program categories: learning date: 2021-07-25T14:06:13+08:00
 title: 程式設計（二）
tags: program 目錄 [toc]
struct 解決 alignment 的問題   __attribute__((packed))
  #pragma pack(push, 1) #pragma pack(pop)   #pragma pack(push) #pragma pack(1) #pragma pack(pop)   File fread  header: <stdio.h> size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream); 務必用型別為size_t 的變數去接回傳值 size 為 1 時，將回傳讀入多少 bytes  Program Arguements getopt *header: <unistd.h> (POSIX standard) 不一定能在windows上呼叫">
<meta property="og:type" content="article">
<meta property="og:url" content="http://example.org/posts/program2/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-07-25T15:07:35+08:00">
<meta property="article:modified_time" content="2021-07-25T15:07:35+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Program2">
<meta name=twitter:description content="title: &ldquo;Program2&rdquo; tags: program categories: learning date: 2021-07-25T14:06:13+08:00
 title: 程式設計（二）
tags: program 目錄 [toc]
struct 解決 alignment 的問題   __attribute__((packed))
  #pragma pack(push, 1) #pragma pack(pop)   #pragma pack(push) #pragma pack(1) #pragma pack(pop)   File fread  header: <stdio.h> size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream); 務必用型別為size_t 的變數去接回傳值 size 為 1 時，將回傳讀入多少 bytes  Program Arguements getopt *header: <unistd.h> (POSIX standard) 不一定能在windows上呼叫">
<meta name=application-name content="饅頭的部落格">
<meta name=apple-mobile-web-app-title content="饅頭的部落格"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/program2/><link rel=prev href=http://example.org/posts/program1/><link rel=next href=http://example.org/posts/learningc++01/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Program2","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/program2\/"},"genre":"posts","wordcount":345,"url":"http:\/\/example.org\/posts\/program2\/","datePublished":"2021-07-25T15:07:35+08:00","dateModified":"2021-07-25T15:07:35+08:00","publisher":{"@type":"Organization","name":"Author"},"author":{"@type":"Person","name":"Author"},"description":""}</script></head>
<body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=饅頭的部落格>饅頭的部落格</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts/> Posts </a><a class=menu-item href=/tags/> Tags </a><a class=menu-item href=/categories/> Categories </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title=饅頭的部落格>饅頭的部落格</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">Program2</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i>Author</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-07-25>2021-07-25</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;345 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;2 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#tags-program>tags: program</a></li>
<li><a href=#目錄>目錄</a>
<ul>
<li><a href=#struct>struct</a></li>
<li><a href=#file>File</a></li>
<li><a href=#program-arguements>Program Arguements</a></li>
<li><a href=#define>#define</a></li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><hr>
<p>title: &ldquo;Program2&rdquo;
tags: program
categories: learning
date: 2021-07-25T14:06:13+08:00</p>
<hr>
<p>title: 程式設計（二）</p>
<h2 id=tags-program>tags: program</h2>
<h2 id=目錄>目錄</h2>
<p>[toc]</p>
<h3 id=struct>struct</h3>
<h4 id=解決-alignment-的問題>解決 alignment 的問題</h4>
<ol>
<li>
<p><code>__attribute__((packed))</code></p>
</li>
<li>
<pre><code class="language-c=" data-lang="c=">#pragma pack(push, 1)
#pragma pack(pop)
</code></pre></li>
<li>
<pre><code class="language-c=" data-lang="c=">#pragma pack(push)
#pragma pack(1)
#pragma pack(pop)
</code></pre></li>
</ol>
<h3 id=file>File</h3>
<h4 id=fread>fread</h4>
<ol>
<li>header: &lt;stdio.h></li>
<li><code>size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream);</code></li>
<li>務必用型別為size_t 的變數去接回傳值</li>
<li>size 為 1 時，將回傳讀入多少 bytes</li>
</ol>
<h3 id=program-arguements>Program Arguements</h3>
<h4 id=getopt>getopt</h4>
<p>*header: &lt;unistd.h> (POSIX standard) 不一定能在windows上呼叫</p>
<ul>
<li><code>int getopt(int argc, char * const argv[], const char *optstring);</code></li>
<li>argc: argument count(前面有加'<code>-</code>'，才會被當作 arguement)</li>
<li>argv: argument array</li>
<li>return value 是 command,若不再optstring 中則回傳 &lsquo;<code>?</code>'，以 -1 標示結尾</li>
<li>opstring: 放 command 的選項，若command後面要加參數，要在該字元後加 &lsquo;<code>:</code>&rsquo;</li>
<li>後接參數放在 optarg ，對於 optarg 要在 while loop 中處(或先 copy 出來)</li>
<li>小建議: switch block 中用變數去紀錄那些功能現在是開啟的 ex: <code>optionA = 1;</code></li>
<li>使用 <code>printusage</code> 去偵錯</li>
</ul>
<h4 id=getopt_long>getopt_long</h4>
<ul>
<li>
<p>header: &lt;getopt.h></p>
</li>
<li>
<p><code>int getopt_long(int argc, char * const argv[], const char *optstring, const struct option *longopts, int *longindex);</code></p>
</li>
<li>
<p>struct option</p>
<pre><code class="language-c=" data-lang="c=">struct option {
    const char *name;
    int has_arg;
    int *flag;
    int val;
};
</code></pre><ul>
<li>使用{0,0,0,0}標示結尾 -> 不用帶入 array 的size</li>
<li>name: the name of the long option.</li>
<li>has_arg:
<ul>
<li>0: no arguments.</li>
<li>1: required arguments.</li>
<li>2: optional arguments.</li>
<li>flag: 當flag 不為 NULL ，將val 傳到 flag 的位址，且回傳值變為 0</li>
<li>val: 設定對應的 name 的 return value</li>
</ul>
</li>
</ul>
</li>
<li>
<p>index</p>
<ul>
<li>option array 中的 index</li>
</ul>
</li>
</ul>
<h4 id=variable-length-arguement>Variable Length Arguement</h4>
<ul>
<li>int printf(const char *format , &mldr;);</li>
<li>void printargs(int32_t args[], &mldr;);</li>
<li>double average(int32_t num, &mldr;);
<ul>
<li><code>...</code> 代表 arguement 的數量可改變
<ul>
<li><code>va_list</code> 可將&mldr;中的變數取出(是一個 Macro )</li>
<li><code>va_start(va_list ap, last)</code> : 設定起始位置</li>
<li><code>va_arg(va_list, last)</code> :設定移動的單位</li>
<li><code>va_end(va_list ap)</code> : 脫鉤</li>
<li><code>va_cpy(va_list dest, va_list src)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id=macro>Macro</h4>
<ul>
<li>在macro 定義一個函式</li>
<li><code>\</code> 表示換行</li>
<li>與一般宣告函式的區別:不占記憶體空間</li>
</ul>
<pre><code class="language-c=" data-lang="c=">#define clearFgets(str,len,stream){\
fgets(str,len,stream);\
if(str[strlen(str)-1]=='\n')\
str[strlen(str)-1]=0;\
}
</code></pre><ul>
<li>Macro 要加<code>()</code></li>
<li>Macro 不加<code>;</code></li>
</ul>
<pre><code class="language-c=" data-lang="c=">#define add(a+b) a+b
int A=add(1+3)*10;
// A=1+3*10=31
</code></pre><pre><code class="language-c=" data-lang="c=">#define add(a+b) (a+b)
int A=add(1+3)*10;
//A=(1+3)*10
</code></pre><ul>
<li>儘量不要加在Macro中宣告參數，避免重複宣告，不好除錯</li>
<li>Macro 無法寫遞迴</li>
</ul>
<h4 id=some-tricks>Some tricks</h4>
<p>待了解: static link,htop,<code>top,htop -d 0</code>,<code>watch -n 0</code>,<code>cat /proc/stat | head -n 1</code>,MITM
待學習: GDB,awk,grep,cMake,makefile
<em><strong>學資料結構時用C</strong></em></p>
<h3 id=define>#define</h3>
<h4 id=ifdef>ifdef</h4>
<h5 id=一個條件>一個條件：</h5>
<ol>
<li></li>
</ol>
<pre><code class="language-=" data-lang="=">#ifdef 識別字
    /*若識別字被定義,編譯器會編譯此部分程式*/
#else
    /*否則編譯此部分程式*/
#endif
</code></pre><ol start=2>
<li></li>
</ol>
<pre><code class="language-=" data-lang="=">#if defined(CONDITION_1)
    /*若識別字被定義,編譯器會編譯此部分程式*/
#elif
    /*否則編譯此部分程式*/
#endif
</code></pre><ol start=3>
<li></li>
</ol>
<pre><code class="language-=" data-lang="=">#define CONDITION_1
#ifdef CONDITION_1
   /*編譯此部分程式*/
#else
   /*不編譯此部分程式*/
#endif
</code></pre><h5 id=兩個以上的條件>兩個以上的條件</h5>
<ol>
<li></li>
</ol>
<pre><code class="language-=" data-lang="=">#if defined(CONDITION_1) &amp;&amp; defined(CONDITION_2)
   /*若條件達成,編譯器會編譯此部分程式*/
#endif
</code></pre><h4 id=ifndef>ifndef</h4>
<pre><code class="language-=" data-lang="=">#ifndef 識別字
   /*若識別字沒有被定義,編譯器會編譯此部分程式*/
#else
   /*否則編譯此部分程式*/
#endif
</code></pre><h4 id=undef>undef</h4>
<pre><code class="language-=" data-lang="=">#undef 識別字
   /*取消定義*/
</code></pre><h4 id=if-elif>#if #elif</h4>
<ol>
<li></li>
</ol>
<pre><code class="language-=" data-lang="=">#if 條件式1
   /*若條件式1成立(true),編譯器會編譯此部分程式*/
#elif 條件式2
   /*若條件式2成立(true),編譯器會編譯此部分程式*/
#else
   /*若上述條件皆不成式,則會編譯此部分程式*/
#endif
</code></pre><ol start=2>
<li></li>
</ol>
<pre><code class="language-=" data-lang="=">/*Eaxmple*/
#define CONDITION 1

#if CONDITION == 1
　 printf(&quot;Condition:1&quot;); //會執行此行程式
#elif CONDITION == 2
   printf(&quot;Condition:2&quot;);
#else
   printf(&quot;Condition:other&quot;);
#endif
</code></pre></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2021-07-25</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/posts/program1/ class=prev rel=prev title=Program1><i class="fas fa-angle-left fa-fw"></i>Program1</a>
<a href=/posts/learningc++01/ class=next rel=next title=LearningC++01>LearningC++01<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.86.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body>
</html>